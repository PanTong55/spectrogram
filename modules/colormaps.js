// modules/colormaps.js
// Provides predefined color maps for the spectrogram viewer.

function generateGrayscale() {
  const arr = [];
  for (let i = 0; i < 256; i++) {
    const v = 1 - i / 255;
    arr.push([v, v, v, 1]);
  }
  return arr;
}

function interpolateStops(stops) {
  const result = [];
  const n = stops.length - 1;
  for (let i = 0; i < 256; i++) {
    const t = i / 255;
    const seg = Math.min(n - 1, Math.floor(t * n));
    const localT = (t - seg / n) * n;
    const [r1, g1, b1] = stops[seg];
    const [r2, g2, b2] = stops[seg + 1];
    const r = r1 + (r2 - r1) * localT;
    const g = g1 + (g2 - g1) * localT;
    const b = b1 + (b2 - b1) * localT;
    result.push([r, g, b, 1]);
  }
  return result;
}

function generateViridis() {
  const stops = [
    [68 / 255, 1 / 255, 84 / 255],    // #440154
    [59 / 255, 82 / 255, 139 / 255],  // #3b528b
    [33 / 255, 145 / 255, 140 / 255], // #21908c
    [94 / 255, 201 / 255, 98 / 255],  // #5ec962
    [253 / 255, 231 / 255, 37 / 255]  // #fde725
  ];
  return interpolateStops(stops);
}

const RGB_COLORMAP = [
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [0.957578, 0.954983, 0.952007, 1],
  [0.982353, 0.989412, 0.976424, 1],
  [0.878616, 0.888685, 0.900000, 1],
  [0.832364, 0.835179, 0.870865, 1],
  [0.841626, 0.786817, 0.822191, 1],
  [0.936528, 0.915121, 0.860865, 1],
  [0.981269, 0.995017, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [0.827140, 0.836482, 0.869377, 1],
  [0.907901, 0.879481, 0.836909, 1],
  [0.986367, 0.942491, 0.864152, 1],
  [0.893264, 0.900000, 0.900000, 1],
  [0.895017, 0.879654, 0.851280, 1],
  [0.962076, 0.986621, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [0.973529, 0.973529, 0.973529, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 1.000000, 1.000000, 1],
  [1.000000, 0.981176, 0.981176, 1],
  [1.000000, 0.981176, 0.981176, 1],
  [1.000000, 0.981176, 0.981176, 1],
  [1.000000, 0.962353, 0.962353, 1],
  [1.000000, 0.962353, 0.962353, 1],
  [1.000000, 0.962353, 0.962353, 1],
  [1.000000, 0.945744, 0.945744, 1],
  [1.000000, 0.943529, 0.943529, 1],
  [1.000000, 0.943529, 0.943529, 1],
  [1.000000, 0.936886, 0.936886, 1],
  [1.000000, 0.924706, 0.924706, 1],
  [1.000000, 0.924706, 0.924706, 1],
  [1.000000, 0.924706, 0.924706, 1],
  [0.950000, 0.855882, 0.855882, 1],
  [1.000000, 0.905882, 0.895825, 1],
  [0.845236, 0.787486, 0.834325, 1],
  [1.000000, 0.884567, 0.877693, 1],
  [0.854383, 0.791592, 0.815179, 1],
  [0.837324, 0.690692, 0.730507, 1],
  [0.941176, 0.817163, 0.817163, 1],
  [0.997093, 0.847486, 0.815836, 1],
  [0.896621, 0.796344, 0.818235, 1],
  [0.785260, 0.582284, 0.648997, 1],
  [0.795502, 0.579723, 0.639931, 1],
  [0.900000, 0.749412, 0.749412, 1],
  [0.842907, 0.677405, 0.687243, 1],
  [1.000000, 0.830588, 0.830588, 1],
  [1.000000, 0.830588, 0.830588, 1],
  [1.000000, 0.830588, 0.830588, 1],
  [1.000000, 0.799216, 0.800784, 1],
  [1.000000, 0.799216, 0.800784, 1],
  [1.000000, 0.799216, 0.800784, 1],
  [1.000000, 0.818039, 0.781961, 1],
  [1.000000, 0.818039, 0.781961, 1],
  [1.000000, 0.818039, 0.781961, 1],
  [1.000000, 0.832434, 0.767566, 1],
  [1.000000, 0.836863, 0.763137, 1],
  [1.000000, 0.836863, 0.763137, 1],
  [1.000000, 0.841292, 0.758708, 1],
  [1.000000, 0.855686, 0.744314, 1],
  [1.000000, 0.855686, 0.744314, 1],
  [1.000000, 0.855686, 0.744314, 1],
  [1.000000, 0.874510, 0.725490, 1],
  [1.000000, 0.874510, 0.725490, 1],
  [1.000000, 0.874510, 0.725490, 1],
  [0.900000, 0.793333, 0.606667, 1],
  [1.000000, 0.893333, 0.706667, 1],
  [1.000000, 0.893333, 0.706667, 1],
  [1.000000, 0.902191, 0.697809, 1],
  [1.000000, 0.912157, 0.687843, 1],
  [1.000000, 0.912157, 0.687843, 1],
  [1.000000, 0.912157, 0.687843, 1],
  [1.000000, 0.930980, 0.669020, 1],
  [1.000000, 0.930980, 0.669020, 1],
  [1.000000, 0.930980, 0.669020, 1],
  [1.000000, 0.949804, 0.650196, 1],
  [1.000000, 0.949804, 0.650196, 1],
  [1.000000, 0.949804, 0.650196, 1],
  [1.000000, 0.968627, 0.631373, 1],
  [1.000000, 0.968627, 0.631373, 1],
  [1.000000, 0.968627, 0.631373, 1],
  [1.000000, 0.987451, 0.612549, 1],
  [1.000000, 0.987451, 0.612549, 1],
  [1.000000, 0.987451, 0.612549, 1],
  [0.995433, 0.985917, 0.575006, 1],
  [0.950000, 0.959412, 0.566794, 1],
  [0.874602, 0.850611, 0.467612, 1],
  [0.854740, 0.882514, 0.467174, 1],
  [0.958535, 0.979239, 0.525075, 1],
  [0.890069, 0.941280, 0.546632, 1],
  [0.836078, 0.892837, 0.534037, 1],
  [0.865882, 0.941176, 0.541176, 1],
  [0.869896, 0.909008, 0.458674, 1],
  [0.874544, 0.949100, 0.544591, 1],
  [0.745952, 0.927336, 0.572734, 1],
  [0.707889, 0.841176, 0.464706, 1],
  [0.787059, 0.900000, 0.500000, 1],
  [0.690542, 0.853829, 0.499008, 1],
  [0.849412, 1.000000, 0.600000, 1],
  [0.849412, 1.000000, 0.600000, 1],
  [0.818408, 1.000000, 0.600000, 1],
  [0.811765, 1.000000, 0.600000, 1],
  [0.811765, 1.000000, 0.600000, 1],
  [0.800692, 1.000000, 0.600000, 1],
  [0.774118, 1.000000, 0.600000, 1],
  [0.774118, 1.000000, 0.600000, 1],
  [0.774118, 1.000000, 0.600000, 1],
  [0.736471, 1.000000, 0.600000, 1],
  [0.736471, 1.000000, 0.600000, 1],
  [0.736471, 1.000000, 0.600000, 1],
  [0.698824, 1.000000, 0.600000, 1],
  [0.698824, 1.000000, 0.600000, 1],
  [0.698824, 1.000000, 0.600000, 1],
  [0.661176, 1.000000, 0.600000, 1],
  [0.661176, 1.000000, 0.600000, 1],
  [0.661176, 1.000000, 0.600000, 1],
  [0.661176, 1.000000, 0.600000, 1],
  [0.623529, 1.000000, 0.600000, 1],
  [0.623529, 1.000000, 0.600000, 1],
  [0.623529, 1.000000, 0.600000, 1],
  [0.600000, 1.000000, 0.600000, 1],
  [0.600000, 1.000000, 0.600000, 1],
  [0.600000, 1.000000, 0.600000, 1],
  [0.600000, 1.000000, 0.637647, 1],
  [0.600000, 1.000000, 0.637647, 1],
  [0.600000, 1.000000, 0.637647, 1],
  [0.600000, 1.000000, 0.675294, 1],
  [0.600000, 1.000000, 0.675294, 1],
  [0.600000, 1.000000, 0.675294, 1],
  [0.600000, 1.000000, 0.701869, 1],
  [0.600000, 1.000000, 0.712941, 1],
  [0.600000, 1.000000, 0.712941, 1],
  [0.600000, 1.000000, 0.719585, 1],
  [0.600000, 1.000000, 0.750588, 1],
  [0.600000, 1.000000, 0.750588, 1],
  [0.600000, 1.000000, 0.750588, 1],
  [0.550000, 0.950000, 0.738235, 1],
  [0.583218, 0.968789, 0.746874, 1],
  [0.510035, 0.897486, 0.682468, 1],
  [0.528051, 0.975202, 0.818293, 1],
  [0.451649, 0.879308, 0.731303, 1],
  [0.460023, 0.828858, 0.672065, 1],
  [0.558824, 0.958824, 0.800208, 1],
  [0.598339, 0.988143, 0.833587, 1],
  [0.484302, 0.923057, 0.813529, 1],
  [0.399677, 0.727612, 0.642330, 1],
  [0.436401, 0.775779, 0.707474, 1],
  [0.500000, 0.900000, 0.801176, 1],
  [0.459585, 0.842388, 0.736724, 1],
  [0.600000, 1.000000, 0.938824, 1],
  [0.600000, 1.000000, 0.938824, 1],
  [0.600000, 1.000000, 0.938824, 1],
  [0.600000, 1.000000, 1.000000, 1],
  [0.600000, 1.000000, 1.000000, 1],
  [0.600000, 1.000000, 1.000000, 1],
  [0.600000, 0.962353, 1.000000, 1],
  [0.600000, 0.962353, 1.000000, 1],
  [0.600000, 0.962353, 1.000000, 1],
  [0.600000, 0.940208, 1.000000, 1],
  [0.600000, 0.924706, 1.000000, 1],
  [0.600000, 0.924706, 1.000000, 1],
  [0.600000, 0.922491, 1.000000, 1],
  [0.600000, 0.887059, 1.000000, 1],
  [0.600000, 0.887059, 1.000000, 1],
  [0.600000, 0.887059, 1.000000, 1],
  [0.600000, 0.849412, 1.000000, 1],
  [0.600000, 0.849412, 1.000000, 1],
  [0.600000, 0.849412, 1.000000, 1],
  [0.517647, 0.736055, 0.917647, 1],
  [0.600000, 0.811765, 1.000000, 1],
  [0.600000, 0.811765, 1.000000, 1],
  [0.600000, 0.800692, 1.000000, 1],
  [0.600000, 0.774118, 1.000000, 1],
  [0.600000, 0.774118, 1.000000, 1],
  [0.600000, 0.774118, 1.000000, 1],
  [0.600000, 0.736471, 1.000000, 1],
  [0.600000, 0.736471, 1.000000, 1],
  [0.600000, 0.736471, 1.000000, 1],
  [0.600000, 0.698824, 1.000000, 1],
  [0.600000, 0.698824, 1.000000, 1],
  [0.600000, 0.698824, 1.000000, 1],
  [0.600000, 0.661176, 1.000000, 1],
  [0.600000, 0.661176, 1.000000, 1],
  [0.600000, 0.661176, 1.000000, 1],
  [0.600000, 0.623529, 1.000000, 1],
  [0.600000, 0.623529, 1.000000, 1],
  [0.600000, 0.623529, 1.000000, 1],
  [0.596678, 0.602215, 0.981822, 1],
  [0.550000, 0.555882, 0.960496, 1],
  [0.600000, 0.600000, 1.000000, 1],
  [0.381869, 0.315156, 0.822907, 1],
  [0.600000, 0.583806, 0.901476, 1],
  [0.511003, 0.534740, 0.906459, 1],
  [0.453725, 0.455986, 0.868120, 1],
  [0.523529, 0.523529, 0.848235, 1],
  [0.581003, 0.539458, 0.793933, 1],
  [0.541788, 0.546632, 0.874706, 1],
  [0.443114, 0.481869, 0.829965, 1],
  [0.407682, 0.405882, 0.730588, 1],
  [0.500000, 0.500000, 0.787059, 1],
  [0.419781, 0.421719, 0.751880, 1],
  [0.600000, 0.600000, 0.849412, 1],
  [0.600000, 0.600000, 0.849412, 1],
  [0.600000, 0.600000, 0.849412, 1],
  [0.600000, 0.600000, 0.811765, 1],
  [0.600000, 0.600000, 0.811765, 1],
  [0.600000, 0.600000, 0.811765, 1],
  [0.600000, 0.600000, 0.774118, 1],
  [0.600000, 0.600000, 0.774118, 1],
  [0.600000, 0.600000, 0.774118, 1],
  [0.600000, 0.600000, 0.736471, 1],
  [0.600000, 0.600000, 0.736471, 1],
  [0.599366, 0.571707, 0.708178, 1],
  [0.600000, 0.600000, 0.703253, 1],
  [0.600000, 0.600000, 0.698824, 1],
  [0.600000, 0.600000, 0.698824, 1],
  [0.600000, 0.600000, 0.685536, 1],
  [0.600000, 0.600000, 0.661176, 1],
  [0.600000, 0.600000, 0.661176, 1],
];

export const COLOR_MAPS = {
  grayscale: generateGrayscale(),
  viridis: generateViridis(),
  rgb: RGB_COLORMAP,
};

export const COLOR_MAP_ITEMS = [
  { label: 'Grayscale', value: 'grayscale' },
  { label: 'Viridis', value: 'viridis' },
  { label: 'Red, Green, Blue', value: 'rgb' },
];

export function getColorMap(name) {
  return COLOR_MAPS[name] || COLOR_MAPS.grayscale;
}
