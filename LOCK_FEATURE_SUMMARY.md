# Power Spectrum 互動鎖定功能 - 實現說明

## 功能概述

在 SVG Power Spectrum 圖表中添加了左鍵點擊鎖定功能，使用戶能夠固定顯示當前的交互元素。

## 功能實現

### 1. **默認交互行為（未鎖定）**
   - 滑鼠在圖表上移動時，根據 X 座標自動檢測最接近的數據點
   - 顯示藍色透明圓點（#0066cc）、輔助線和提示框
   - 滑鼠離開圖表時，清空所有顯示

### 2. **左鍵點擊鎖定功能**
   - **首次點擊**（未鎖定）：
     - 在滑鼠位置找到最接近的數據點（檢測範圍 15px）
     - 鎖定該點的顯示
     - 透明圓點顏色變為紅色（#ff0000）
     - 停止基於 X 座標的自動檢測交互
     - 滑鼠移動和離開圖表時，鎖定的顯示保持不變

   - **再次點擊**（已鎖定）：
     - 解除當前的鎖定狀態
     - 清空所有顯示
     - 恢復基於 X 座標的自動檢測交互
     - 滑鼠移動時重新顯示交互元素（藍色圓點）

### 3. **邊界處理**
   - 在圖表區域外點擊時，若已鎖定則解除鎖定
   - 鎖定狀態下滑鼠離開圖表，顯示仍保持（不同於未鎖定狀態）

## 技術實現細節

### 狀態管理
```javascript
let lockedPoint = null;      // 儲存鎖定點的資訊
let isLocked = false;        // 鎖定狀態標誌
```

### 修改的事件監聽器

1. **mousemove 事件**
   - 添加條件檢查：若 `isLocked` 為 true，則直接返回，不執行自動檢測
   - 保留未鎖定時的原有行為

2. **mouseleave 事件**
   - 修改以支持鎖定狀態：只有未鎖定時才清空顯示
   - 鎖定時顯示保持

3. **click 事件（新增）**
   - 檢測滑鼠是否在圖表區域內
   - 根據鎖定狀態執行相應操作：
     - 未鎖定：尋找最接近的點並鎖定（圓點變紅色）
     - 已鎖定：解除鎖定並清空顯示

### 顏色方案
- **未鎖定時的圓點**：藍色 `rgba(0, 102, 204, 0.3)` / `#0066cc`
- **鎖定時的圓點**：紅色 `rgba(255, 0, 0, 0.3)` / `#ff0000`

## 用戶體驗流程

1. 用戶在圖表上移動滑鼠 → 看到藍色圓點和輔助線跟隨移動
2. 用戶在感興趣的點上左鍵點擊 → 圓點變紅色，固定顯示，鎖定該點
3. 滑鼠移動時顯示不再變化 → 可以清楚查看該點的詳細信息
4. 用戶再次左鍵點擊 → 解除鎖定，恢復原有交互行為

## 相關文件
- 修改文件：`modules/powerSpectrum.js`
- 修改函數：`drawPowerSpectrumSVG()`
